<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/engine/renderer.js - Panda.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../../img/logo_small2.png" title="Panda.js"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.13.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/game.Analytics.html">game.Analytics</a></li>
                                <li><a href="../classes/game.Animation.html">game.Animation</a></li>
                                <li><a href="../classes/game.Audio.html">game.Audio</a></li>
                                <li><a href="../classes/game.BaseTexture.html">game.BaseTexture</a></li>
                                <li><a href="../classes/game.BitmapText.html">game.BitmapText</a></li>
                                <li><a href="../classes/game.Body.html">game.Body</a></li>
                                <li><a href="../classes/game.Camera.html">game.Camera</a></li>
                                <li><a href="../classes/game.Circle.html">game.Circle</a></li>
                                <li><a href="../classes/game.Class.html">game.Class</a></li>
                                <li><a href="../classes/game.CollisionSolver.html">game.CollisionSolver</a></li>
                                <li><a href="../classes/game.Container.html">game.Container</a></li>
                                <li><a href="../classes/game.Core.html">game.Core</a></li>
                                <li><a href="../classes/game.Debug.html">game.Debug</a></li>
                                <li><a href="../classes/game.DebugDraw.html">game.DebugDraw</a></li>
                                <li><a href="../classes/game.DisplayObject.html">game.DisplayObject</a></li>
                                <li><a href="../classes/game.Emitter.html">game.Emitter</a></li>
                                <li><a href="../classes/game.Graphics.html">game.Graphics</a></li>
                                <li><a href="../classes/game.Keyboard.html">game.Keyboard</a></li>
                                <li><a href="../classes/game.Loader.html">game.Loader</a></li>
                                <li><a href="../classes/game.Particle.html">game.Particle</a></li>
                                <li><a href="../classes/game.Point.html">game.Point</a></li>
                                <li><a href="../classes/game.Pool.html">game.Pool</a></li>
                                <li><a href="../classes/game.Rectangle.html">game.Rectangle</a></li>
                                <li><a href="../classes/game.RenderTexture.html">game.RenderTexture</a></li>
                                <li><a href="../classes/game.Scene.html">game.Scene</a></li>
                                <li><a href="../classes/game.Spine.html">game.Spine</a></li>
                                <li><a href="../classes/game.Sprite.html">game.Sprite</a></li>
                                <li><a href="../classes/game.SpriteSheet.html">game.SpriteSheet</a></li>
                                <li><a href="../classes/game.Storage.html">game.Storage</a></li>
                                <li><a href="../classes/game.System.html">game.System</a></li>
                                <li><a href="../classes/game.Text.html">game.Text</a></li>
                                <li><a href="../classes/game.Texture.html">game.Texture</a></li>
                                <li><a href="../classes/game.TilingSprite.html">game.TilingSprite</a></li>
                                <li><a href="../classes/game.Timer.html">game.Timer</a></li>
                                <li><a href="../classes/game.Tween.html">game.Tween</a></li>
                                <li><a href="../classes/game.TweenEngine.html">game.TweenEngine</a></li>
                                <li><a href="../classes/game.TweenGroup.html">game.TweenGroup</a></li>
                                <li><a href="../classes/game.Vector.html">game.Vector</a></li>
                                <li><a href="../classes/game.Video.html">game.Video</a></li>
                                <li><a href="../classes/game.World.html">game.World</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/analytics.html">analytics</a></li>
                                <li><a href="../modules/audio.html">audio</a></li>
                                <li><a href="../modules/camera.html">camera</a></li>
                                <li><a href="../modules/debug.html">debug</a></li>
                                <li><a href="../modules/game.html">game</a></li>
                                <li><a href="../modules/keyboard.html">keyboard</a></li>
                                <li><a href="../modules/loader.html">loader</a></li>
                                <li><a href="../modules/particle.html">particle</a></li>
                                <li><a href="../modules/physics.html">physics</a></li>
                                <li><a href="../modules/pool.html">pool</a></li>
                                <li><a href="../modules/renderer.html">renderer</a></li>
                                <li><a href="../modules/scene.html">scene</a></li>
                                <li><a href="../modules/storage.html">storage</a></li>
                                <li><a href="../modules/system.html">system</a></li>
                                <li><a href="../modules/timer.html">timer</a></li>
                                <li><a href="../modules/tween.html">tween</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited">
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/engine/renderer.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
    @module renderer
    @namespace game
**/
game.module(
    &#x27;engine.renderer&#x27;
)
.require(
    &#x27;engine.pixi&#x27;
)
.body(function() {
&#x27;use strict&#x27;;

game.PIXI.dontSayHello = true;
game.PIXI.RETINA_PREFIX = false;

game.autoDetectRenderer = game.PIXI.autoDetectRenderer;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/MovieClip.html
    @class Animation
    @extends game.DisplayObject
    @constructor
    @param {Array} textures Textures this animation made up of
**/
game.Animation = function(textures) {
    /**
        Play animation in reverse.
        @property {Boolean} reverse
        @default false
    **/
    this.reverse = false;

    if (typeof textures === &#x27;string&#x27;) {
        var frames = Array.prototype.slice.call(arguments);

        var textures = [];
        for (var i = 0; i &lt; frames.length; i++) {
            textures.push(game.Texture.fromImage(frames[i]));
        }
    }

    game.PIXI.MovieClip.call(this, textures);
};

game.Animation.prototype = Object.create(game.PIXI.MovieClip.prototype);
game.Animation.prototype.constructor = game.Animation;

/**
    Play animation.
    @method play
    @param {Boolean} loop
**/
game.Animation.prototype.play = function(loop) {
    if (typeof loop === &#x27;boolean&#x27;) this.loop = loop;
    this.playing = true;
};

game.Animation.prototype.updateTransform = function() {
    if (this.playing) {
        this.currentFrame -= this.animationSpeed;
        this.currentFrame += this.animationSpeed * (this.reverse ? -1 : 1) * 60 * game.system.delta;
        
        if (this.currentFrame &lt; 0 &amp;&amp; this.reverse) {
            if (!this.loop) {
                if (this.onComplete) this.onComplete();
                this.currentFrame = 0;
                this.playing = false;
            }
            else this.currentFrame = this.totalFrames - 1 + this.currentFrame;
        }
    }
    game.PIXI.MovieClip.prototype.updateTransform.call(this);
};

/**
    @method fromFrames
    @static
    @param {String} name
    @param {Boolean} reverse
**/
game.Animation.fromFrames = function(name, reverse) {
    var textures = [];

    for (var key in game.TextureCache) {
        if (key.indexOf(name) !== -1) {
            if (reverse) textures.unshift(game.TextureCache[key]);
            else textures.push(game.TextureCache[key]);
        }
    }

    return new game.Animation(textures);
};

game.AssetLoader = game.PIXI.AssetLoader;
game.blendModes = game.PIXI.blendModes;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/BaseTexture.html
    @class BaseTexture
**/
game.BaseTexture = game.PIXI.BaseTexture;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/BitmapText.html
    @class BitmapText
**/
game.BitmapText = game.PIXI.BitmapText;
game.CanvasRenderer = game.PIXI.CanvasRenderer;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/DisplayObjectContainer.html
    @class Container
    @extends game.DisplayObject
**/
game.Container = game.PIXI.DisplayObjectContainer;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/DisplayObject.html
    @class DisplayObject
**/
game.DisplayObject = game.PIXI.DisplayObject;

/**
    Remove from it&#x27;s parent.
    @method remove
**/
game.DisplayObject.prototype.remove = function() {
    if (this.parent) this.parent.removeChild(this);
};

/**
    Add to container.
    @method addTo
    @param {game.DisplayObject|game.Container} container
**/
game.DisplayObject.prototype.addTo = function(container) {
    container.addChild(this);
    return this;
};

/**
    http://www.goodboydigital.com/pixijs/docs/classes/Graphics.html
    @class Graphics
    @extends game.DisplayObject
**/
game.Graphics = game.PIXI.Graphics;
game.HitCircle = game.PIXI.Circle;
game.HitEllipse = game.PIXI.Ellipse;
game.HitPolygon = game.PIXI.Polygon;
game.HitRectangle = game.PIXI.Rectangle;
/**
    http://www.goodboydigital.com/pixijs/docs/classes/Point.html
    @class Point
**/
game.Point = game.PIXI.Point;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/RenderTexture.html
    @class RenderTexture
**/
game.RenderTexture = game.PIXI.RenderTexture;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/Spine.html
    @class Spine
    @extends game.DisplayObject
    @constructor
    @param {String} id Asset ID
    @param {Object} [properties] Properties to merge to this animation
**/
game.Spine = function(id, properties) {
    game.PIXI.Spine.call(this, game.paths[id] || id);
    game.merge(this, properties);
};

game.Spine.prototype = Object.create(game.PIXI.Spine.prototype);
game.Spine.prototype.constructor = game.Spine;

/**
    Play animation.
    @method play
    @param {String} anim Name of animation.
    @param {Boolean} loop Animation looping.
    @param {Boolean} after Start after current animation.
**/
game.Spine.prototype.play = function(anim, loop, after) {
    if (after) this.state.addAnimationByName(anim, !!loop);
    else this.state.setAnimationByName(anim, !!loop);
};

/**
    Mix two animations for smooth transition.
    @method mix
    @param {String} from Animation name to mix from.
    @param {String} to Animation name to mix to.
    @param {Number} value Percent of mix.
**/
game.Spine.prototype.mix = function(from, to, value) {
    this.stateData.setMixByName(from, to, value / 100);
};

/**
    http://www.goodboydigital.com/pixijs/docs/classes/Sprite.html
    @class Sprite
    @extends game.DisplayObject
    @constructor
    @param {String} texture
    @param {Number} [x]
    @param {Number} [y]
    @param {Object} [properties]
**/
game.Sprite = function(texture, x, y, properties) {
    if (typeof texture === &#x27;string&#x27;) {
        texture = game.paths[texture] || texture;
        texture = game.Texture.fromFrame(texture);
    }
    game.PIXI.Sprite.call(this, texture);

    game.merge(this, properties);

    this.position.set(x * game.scale, y * game.scale);

    // Auto bind touch events for mobile
    if (game.device.mobile &amp;&amp; !this.tap &amp;&amp; this.click) this.tap = this.click;
    if (game.device.mobile &amp;&amp; !this.touchmove &amp;&amp; this.mousemove) this.touchmove = this.mousemove;
    if (game.device.mobile &amp;&amp; !this.touchstart &amp;&amp; this.mousedown) this.touchstart = this.mousedown;
    if (game.device.mobile &amp;&amp; !this.touchend &amp;&amp; this.mouseup) this.touchend = this.mouseup;
    if (game.device.mobile &amp;&amp; !this.touchendoutside &amp;&amp; this.mouseupoutside) this.touchendoutside = this.mouseupoutside;
};

game.Sprite.prototype = Object.create(game.PIXI.Sprite.prototype);
game.Sprite.prototype.constructor = game.Sprite;

game.Sprite.prototype.setTexture = function(texture) {
    if (typeof texture === &#x27;string&#x27;) {
        texture = game.paths[texture] || texture;
        texture = game.Texture.fromFrame(texture);
    }
    game.PIXI.Sprite.prototype.setTexture.call(this, texture);
};

/**
    Crop sprite.
    @method crop
    @param {Number} x The x coordinate of left-top point to crop
    @param {Number} y The y coordinate of left-top point to crop
    @param {Number} width The width of sprite to crop to
    @param {Number} height The height of sprite to crop to
    @chainable
**/
game.Sprite.prototype.crop = function(x, y, width, height) {
    var texture = new game.PIXI.Texture(this.texture, new game.HitRectangle(x, y, width, height));
    this.setTexture(texture);
    return this;
};

/**
    Position sprite to system center.
    @method center
    @param {Number} offsetX Offset x coordinate to system center
    @param {Number} offsetY Offset y coordinate to system center
    @chainable
**/
game.Sprite.prototype.center = function(offsetX, offsetY) {
    this.position.x = game.system.width / 2 - this.width / 2 + this.width * this.anchor.x;
    this.position.y = game.system.height / 2 - this.height / 2 + this.height * this.anchor.y;
    this.position.x += offsetX || 0;
    this.position.y += offsetY || 0;
    return this;
};

game.Sprite.fromFrame = game.PIXI.Sprite.fromFrame;
game.Sprite.fromImage = game.PIXI.Sprite.fromImage;

game.Stage = game.PIXI.Stage;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/Text.html
    @class Text
**/
game.Text = game.PIXI.Text;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/Texture.html
    @class Texture
**/
game.Texture = game.PIXI.Texture;

/**
    @property {Object} TextureCache
    @for game.Core
**/
game.TextureCache = game.PIXI.TextureCache;

/**
    http://www.goodboydigital.com/pixijs/docs/classes/TilingSprite.html
    @class TilingSprite
    @extends game.DisplayObject
    @constructor
    @param {String|game.Texture} texture Texture to be repeated
    @param {Number} width Sprite width
    @param {Number} height Sprite height
    @param {Object} [properties] Properties to be merged into this sprite
**/
game.TilingSprite = function(path, width, height, properties) {
    /**
        Texture scroll speed
        @property {game.Point} speed
    **/
    this.speed = new game.Point();
    path = game.paths[path] || path;
    var texture = path instanceof game.Texture ? path : path instanceof game.RenderTexture ? path : game.Texture.fromFrame(this.path || path);
    game.PIXI.TilingSprite.call(this, texture, width || texture.width, height || texture.height);
    game.merge(this, properties);
};

game.TilingSprite.prototype = Object.create(game.PIXI.TilingSprite.prototype);
game.TilingSprite.prototype.constructor = game.TilingSprite;

/**
    Update tile position with speed.
    @method update
**/
game.TilingSprite.prototype.update = function() {
    this.tilePosition.x += this.speed.x * game.system.delta;
    this.tilePosition.y += this.speed.y * game.system.delta;
};

/**
    @class SpriteSheet
    @extends game.Class
    @constructor
    @param {String} id Asset ID
    @param {Number} width Sprite frame width
    @param {Number} height Sprite frame height
**/
game.createClass(&#x27;SpriteSheet&#x27;, {
    /**
        @propety {Array} textures
    **/
    textures: [],
    /**
        Number of frames
        @property {Number} frames
    **/
    frames: 0,

    init: function(id, width, height) {
        this.width = width;
        this.height = height;
        var baseTexture = game.TextureCache[game.paths[id]];
        this.sx = Math.floor(baseTexture.width / this.width);
        this.sy = Math.floor(baseTexture.height / this.height);
        this.frames = this.sx * this.sy;

        for (var i = 0; i &lt; this.frames; i++) {
            var x = (i % this.sx) * this.width;
            var y = Math.floor(i / this.sx) * this.height;
            var texture = new game.Texture(baseTexture, new game.HitRectangle(x, y, this.width, this.height));
            this.textures.push(texture);
        }
    },

    /**
        Create sprite from specific frame.
        @method frame
        @param {Number} index Frame index
        @return {game.Sprite}
    **/
    frame: function(index) {
        index = index.limit(0, this.frames - 1);
        return new game.Sprite(this.textures[index]);
    },

    /**
        Create animation from spritesheet.
        @method anim
        @param {Number|Array} frames List or number of frames
        @param {Number} [startIndex] The index to begin with, default to 0
        @param {Boolean} [onlyTextures] Return only textures
        @return {game.Animation|Array}
    **/
    anim: function(frames, startIndex, onlyTextures) {
        startIndex = startIndex || 0;
        frames = frames || this.frames;
        var textures = [];
        if (frames.length &gt; 0) {
            for (var i = 0; i &lt; frames.length; i++) {
                textures.push(this.textures[startIndex + frames[i]]);
            }
        }
        else {
            for (var i = 0; i &lt; frames; i++) {
                textures.push(this.textures[startIndex + i]);
            }
        }
        if (onlyTextures) return textures;
        return new game.Animation(textures);
    }
});

/**
    @class Video
    @extends game.Class
    @constructor
    @param {String} source
**/
game.createClass(&#x27;Video&#x27;, {
    /**
        @property {Boolean} loop
        @default false
    **/
    loop: false,
    /**
        Video element.
        @property {Video} videoElem
    **/
    videoElem: null,
    /**
        Video sprite.
        @property {game.Sprite} sprite
    **/
    sprite: null,

    init: function() {
        this.videoElem = document.createElement(&#x27;video&#x27;);
        this.videoElem.addEventListener(&#x27;ended&#x27;, this._complete.bind(this));

        var urls = Array.prototype.slice.call(arguments);
        var source;
        for (var i = 0; i &lt; urls.length; i++) {
            source = document.createElement(&#x27;source&#x27;);
            source.src = game.getMediaPath(urls[i]);
            this.videoElem.appendChild(source);
        }

        var videoTexture = game.PIXI.VideoTexture.textureFromVideo(this.videoElem);
        videoTexture.baseTexture.addEventListener(&#x27;loaded&#x27;, this._loaded.bind(this));

        this.sprite = new game.Sprite(videoTexture);
    },

    /**
        @method _loaded
        @private
    **/
    _loaded: function() {
        if (typeof this._loadCallback === &#x27;function&#x27;) this._loadCallback();
    },

    /**
        @method _complete
        @private
    **/
    _complete: function() {
        if (typeof this._completeCallback === &#x27;function&#x27;) this._completeCallback();
    },

    /**
        @method onLoaded
        @param {Function} callback
    **/
    onLoaded: function(callback) {
        this._loadCallback = callback;
    },

    /**
        @method onComplete
        @param {Function} callback
    **/
    onComplete: function(callback) {
        this._completeCallback = callback;
    },

    /**
        @method play
    **/
    play: function() {
        this.videoElem.loop = !!this.loop;
        this.videoElem.play();
    },

    /**
        @method stop
        @param {Boolean} remove
    **/
    stop: function(remove) {
        this.videoElem.pause();
        if (remove) this.sprite.remove();
    }
});

});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
