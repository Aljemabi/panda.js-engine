<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/engine/system.js - Panda.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../../img/logo_small2.png" title="Panda.js"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.13.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/game.Analytics.html">game.Analytics</a></li>
                                <li><a href="../classes/game.Animation.html">game.Animation</a></li>
                                <li><a href="../classes/game.Audio.html">game.Audio</a></li>
                                <li><a href="../classes/game.BaseTexture.html">game.BaseTexture</a></li>
                                <li><a href="../classes/game.BitmapText.html">game.BitmapText</a></li>
                                <li><a href="../classes/game.Body.html">game.Body</a></li>
                                <li><a href="../classes/game.Camera.html">game.Camera</a></li>
                                <li><a href="../classes/game.Circle.html">game.Circle</a></li>
                                <li><a href="../classes/game.Class.html">game.Class</a></li>
                                <li><a href="../classes/game.CollisionSolver.html">game.CollisionSolver</a></li>
                                <li><a href="../classes/game.Container.html">game.Container</a></li>
                                <li><a href="../classes/game.Core.html">game.Core</a></li>
                                <li><a href="../classes/game.Debug.html">game.Debug</a></li>
                                <li><a href="../classes/game.DebugDraw.html">game.DebugDraw</a></li>
                                <li><a href="../classes/game.DisplayObject.html">game.DisplayObject</a></li>
                                <li><a href="../classes/game.Emitter.html">game.Emitter</a></li>
                                <li><a href="../classes/game.Graphics.html">game.Graphics</a></li>
                                <li><a href="../classes/game.Keyboard.html">game.Keyboard</a></li>
                                <li><a href="../classes/game.Loader.html">game.Loader</a></li>
                                <li><a href="../classes/game.Particle.html">game.Particle</a></li>
                                <li><a href="../classes/game.Point.html">game.Point</a></li>
                                <li><a href="../classes/game.Pool.html">game.Pool</a></li>
                                <li><a href="../classes/game.Rectangle.html">game.Rectangle</a></li>
                                <li><a href="../classes/game.RenderTexture.html">game.RenderTexture</a></li>
                                <li><a href="../classes/game.Scene.html">game.Scene</a></li>
                                <li><a href="../classes/game.Spine.html">game.Spine</a></li>
                                <li><a href="../classes/game.Sprite.html">game.Sprite</a></li>
                                <li><a href="../classes/game.SpriteSheet.html">game.SpriteSheet</a></li>
                                <li><a href="../classes/game.Storage.html">game.Storage</a></li>
                                <li><a href="../classes/game.System.html">game.System</a></li>
                                <li><a href="../classes/game.Text.html">game.Text</a></li>
                                <li><a href="../classes/game.Texture.html">game.Texture</a></li>
                                <li><a href="../classes/game.TilingSprite.html">game.TilingSprite</a></li>
                                <li><a href="../classes/game.Timer.html">game.Timer</a></li>
                                <li><a href="../classes/game.Tween.html">game.Tween</a></li>
                                <li><a href="../classes/game.TweenEngine.html">game.TweenEngine</a></li>
                                <li><a href="../classes/game.TweenGroup.html">game.TweenGroup</a></li>
                                <li><a href="../classes/game.Vector.html">game.Vector</a></li>
                                <li><a href="../classes/game.Video.html">game.Video</a></li>
                                <li><a href="../classes/game.World.html">game.World</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/analytics.html">analytics</a></li>
                                <li><a href="../modules/audio.html">audio</a></li>
                                <li><a href="../modules/camera.html">camera</a></li>
                                <li><a href="../modules/debug.html">debug</a></li>
                                <li><a href="../modules/game.html">game</a></li>
                                <li><a href="../modules/keyboard.html">keyboard</a></li>
                                <li><a href="../modules/loader.html">loader</a></li>
                                <li><a href="../modules/particle.html">particle</a></li>
                                <li><a href="../modules/physics.html">physics</a></li>
                                <li><a href="../modules/pool.html">pool</a></li>
                                <li><a href="../modules/renderer.html">renderer</a></li>
                                <li><a href="../modules/scene.html">scene</a></li>
                                <li><a href="../modules/storage.html">storage</a></li>
                                <li><a href="../modules/system.html">system</a></li>
                                <li><a href="../modules/timer.html">timer</a></li>
                                <li><a href="../modules/tween.html">tween</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited">
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/engine/system.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
    @module system
    @namespace game
**/
game.module(
    &#x27;engine.system&#x27;
)
.body(function() {
&#x27;use strict&#x27;;

/**
    @class System
    @extends game.Class
**/
game.createClass(&#x27;System&#x27;, {
    /**
        Name of current scene.
        @property {String} currentSceneName
    **/
    currentSceneName: null,
    /**
        Width of the game screen.
        @property {Number} width
    **/
    width: null,
    /**
        Height of the game screen.
        @property {Number} height
    **/
    height: null,
    /**
        Current delta-time.
        @property {Number} delta
    **/
    delta: 0,
    /**
        Main game timer.
        @property {Timer} timer
    **/
    timer: null,
    /**
        Canvas element.
        @property {HTMLCanvasElement} canvas
    **/
    canvas: null,
    /**
        Is engine paused.
        @property {Boolean} paused
    **/
    paused: false,
    /**
        Is engine in HiRes mode.
        @property {Boolean} hires
    **/
    hires: false,
    /**
        Is engine in Retina mode.
        @property {Boolean} retina
    **/
    retina: false,
    /**
        Is mobile rotate screen visible.
        @property {Boolean} rotateScreenVisible
    **/
    rotateScreenVisible: false,
    /**
        Current id of the game loop.
        @property {Number} gameLoopId
    **/
    gameLoopId: 0,
    /**
        Is WebGL enabled.
        @property {Boolean} webGL
    **/
    webGL: false,
    /**
        Original width.
        @property {Number} originalWidth
    **/
    originalWidth: null,
    /**
        Original height.
        @property {Number} originalHeight
    **/
    originalHeight: null,
    newSceneClass: null,
    running: false,

    init: function() {
        var width = game.System.width;
        var height = game.System.height;
        if (width === &#x27;window&#x27;) width = window.innerWidth;
        if (height === &#x27;window&#x27;) height = window.innerHeight;
        this.originalWidth = width;
        this.originalHeight = height;

        for (var i = 2; i &lt;= game.System.hires; i *= 2) {
            if (window.innerWidth &gt;= width * i &amp;&amp; window.innerHeight &gt;= height * i) {
                this.hires = true;
                game.scale = i;
            }
        }
        if (this.hires) {
            width *= game.scale;
            height *= game.scale;
        }
        if (game.System.retina &amp;&amp; game.device.pixelRatio === 2) {
            // Check if we are already using highest textures
            if (game.scale &lt; game.System.hires) {
                this.retina = true;
                width *= 2;
                height *= 2;
                game.scale *= 2;
            }
        }

        this.width = width;
        this.height = height;
        this.canvasId = game.System.canvasId;
        this.timer = new game.Timer();

        this.initRenderer(width, height);

        game.normalizeVendorAttribute(this.canvas, &#x27;requestFullscreen&#x27;);
        game.normalizeVendorAttribute(this.canvas, &#x27;requestFullScreen&#x27;);
        game.normalizeVendorAttribute(navigator, &#x27;vibrate&#x27;);

        document.body.style.margin = 0;

        if (this.retina) {
            this.canvas.style.width = width / 2 + &#x27;px&#x27;;
            this.canvas.style.height = height / 2 + &#x27;px&#x27;;
        }
        else {
            this.canvas.style.width = width + &#x27;px&#x27;;
            this.canvas.style.height = height + &#x27;px&#x27;;
        }

        window.addEventListener(&#x27;devicemotion&#x27;, function(event) {
            game.accelerometer = game.accel = event.accelerationIncludingGravity;
        }, false);

        game.renderer = this.renderer;

        if (!game.device.cocoonJS) {
            var visibilityChange;
            if (typeof document.hidden !== &#x27;undefined&#x27;) {
                visibilityChange = &#x27;visibilitychange&#x27;;
            }
            else if (typeof document.mozHidden !== &#x27;undefined&#x27;) {
                visibilityChange = &#x27;mozvisibilitychange&#x27;;
            }
            else if (typeof document.msHidden !== &#x27;undefined&#x27;) {
                visibilityChange = &#x27;msvisibilitychange&#x27;;
            }
            else if (typeof document.webkitHidden !== &#x27;undefined&#x27;) {
                visibilityChange = &#x27;webkitvisibilitychange&#x27;;
            }

            document.addEventListener(visibilityChange, function() {
                if (game.System.pauseOnHide) {
                    var hidden = !!game.getVendorAttribute(document, &#x27;hidden&#x27;);
                    if (hidden) game.system.pause(true);
                    else game.system.resume(true);
                }
            }, false);

            if (game.System.bgColor &amp;&amp; !game.System.bgColorMobile) game.System.bgColorMobile = game.System.bgColor;
            if (game.System.bgColorMobile &amp;&amp; !game.System.bgColorRotate) game.System.bgColorRotate = game.System.bgColorMobile;

            if (game.System.bgImage &amp;&amp; !game.System.bgImageMobile) game.System.bgImageMobile = game.System.bgImage;
            if (game.System.bgImageMobile &amp;&amp; !game.System.bgImageRotate) game.System.bgImageRotate = game.System.bgImageMobile;

            if (!game.device.mobile) {
                if (game.System.bgColor) document.body.style.backgroundColor = game.System.bgColor;
                if (game.System.bgImage) document.body.style.backgroundImage = &#x27;url(&#x27; + game.getMediaPath(game.System.bgImage) + &#x27;)&#x27;;
            }
            if (game.System.bgPosition) document.body.style.backgroundPosition = game.System.bgPosition;

            this.initResize();
        }
        else {
            this.resizeToFill();
            this.canvas.style.cssText = &#x27;idtkscale:&#x27; + game.System.idtkScale + &#x27;;&#x27;;
        }
    },

    initRenderer: function(width, height) {
        if (!document.getElementById(this.canvasId)) {
            var canvas = document.createElement(&#x27;canvas&#x27;);
            if (game.device.cocoonJS) canvas.screencanvas = !!game.System.screenCanvas;
            canvas.id = this.canvasId;
            document.body.appendChild(canvas);
        }
        
        game.PIXI.scaleModes.DEFAULT = game.PIXI.scaleModes[game.System.scaleMode.toUpperCase()] || 0;

        if (game.System.webGL &amp;&amp; game.device.cocoonJS) {
            width = window.innerWidth * game.device.pixelRatio;
            height = window.innerHeight * game.device.pixelRatio;
        }

        if (game.System.webGL) this.renderer = game.autoDetectRenderer(width, height, {
            view: document.getElementById(this.canvasId),
            transparent: game.System.transparent,
            antialias: game.System.antialias
        });
        else this.renderer = new game.CanvasRenderer(width, height, {
            view: document.getElementById(this.canvasId),
            transparent: game.System.transparent
        });

        this.webGL = !!this.renderer.gl;
        this.canvas = this.renderer.view;
        this.stage = new game.Stage();
    },

    resizeToFill: function() {
        if (!game.System.resizeToFill || !game.device.mobile) return;
        if (this.rotateScreenVisible) return;

        if (this._resizeToFill) return;
        this._resizeToFill = true;

        var gameOrientation = this.width &gt; this.height ? &#x27;landscape&#x27; : &#x27;portrait&#x27;;
        var gameRatio = this.width / this.height;
        var screenOrientation = window.innerWidth &gt; window.innerHeight ? &#x27;landscape&#x27; : &#x27;portrait&#x27;;
        var screenRatio = window.innerWidth / window.innerHeight;

        if (screenRatio !== gameRatio &amp;&amp; gameOrientation === screenOrientation) {
            if (gameRatio &lt; screenRatio) {
                // Letterbox left/right
                this.width = Math.round(this.height * (window.innerWidth / window.innerHeight));
            }
            else {
                // Letterbox top/bottom
                this.height = Math.round(this.width * (window.innerHeight / window.innerWidth));
            }
            this.resize(this.width, this.height);
        }
    },

    /**
        Vibrate device.
        @method vibrate
        @param {Number} time Time to vibrate.
    **/
    vibrate: function(time) {
        if (navigator.vibrate) return navigator.vibrate(time);
        return false;
    },

    /**
        Pause game engine.
        @method pause
    **/
    pause: function(onHide) {
        if (this.paused) return;
        if (onHide) this.pausedOnHide = true;
        else this.paused = true;

        if (game.scene) game.scene.pause();
    },

    /**
        Resume paused game engine.
        @method resume
    **/
    resume: function(onHide) {
        if (onHide &amp;&amp; this.paused) return;
        if (!onHide &amp;&amp; !this.paused) return;
        if (onHide) this.pausedOnHide = false;
        else this.paused = false;

        game.Timer.last = Date.now();
        if (game.scene) game.scene.resume();
    },

    /**
        Change current scene.
        @method setScene
        @param {String} sceneClass
        @param {Boolean} removeAssets
    **/
    setScene: function(sceneClass, removeAssets) {
        this.currentSceneName = sceneClass;
        sceneClass = game[&#x27;Scene&#x27; + sceneClass];
        if (this.running &amp;&amp; !this.paused) {
            this.newSceneClass = sceneClass;
            this.removeAssets = removeAssets;
        }
        else this.setSceneNow(sceneClass, removeAssets);
    },

    setSceneNow: function(sceneClass, removeAssets) {
        if (this.paused) this.paused = false;
        if (game.scene) game.scene.exit();
        if (game.tweenEngine) game.tweenEngine.tweens.length = 0;
        if (removeAssets) game.removeAssets();
        game.scene = new (sceneClass)();
        if (game.Debug &amp;&amp; game.Debug.enabled &amp;&amp; !game.device.cocoonJS &amp;&amp; !this.debug) this.debug = new game.Debug();
        this.newSceneClass = null;
        this.startRunLoop();
    },

    startRunLoop: function() {
        if (this.gameLoopId) this.stopRunLoop();
        this.gameLoopId = game.setGameLoop(this.run.bind(this), this.canvas);
        this.running = true;
    },

    stopRunLoop: function() {
        game.clearGameLoop(this.gameLoopId);
        this.running = false;
    },

    run: function() {
        if (this.paused || this.pausedOnHide) return;

        game.Timer.update();
        this.delta = this.timer.delta() / 1000;

        if (this.debug) this.debug.reset();

        game.scene.run();

        if (this.debug) this.debug.update();
        if (this.newSceneClass) this.setSceneNow(this.newSceneClass, this.removeAssets);
    },

    resize: function(width, height) {
        this.width = this.canvas.width = width;
        this.height = this.canvas.height = height;
        this.canvas.style.width = width + &#x27;px&#x27;;
        this.canvas.style.height = height + &#x27;px&#x27;;
        this.renderer.resize(this.width, this.height);
    },

    initResize: function() {
        this.ratio = this.width &gt; this.height ? this.width / this.height : this.height / this.width;

        if (game.System.center) this.canvas.style.margin = &#x27;auto&#x27;;

        if (game.device.mobile) {
            // Mobile position
            if (!game.System.center) {
                this.canvas.style.position = &#x27;absolute&#x27;;
                this.canvas.style.left = game.System.left + &#x27;px&#x27;;
                this.canvas.style.top = game.System.top + &#x27;px&#x27;;
            }

            document.addEventListener(&#x27;touchstart&#x27;, function(e) {
                e.preventDefault();
            }, false);

            if (game.System.rotateScreen) {
                var div = document.createElement(&#x27;div&#x27;);
                div.innerHTML = game.System.rotateImg ? &#x27;&#x27; : game.System.rotateMsg;
                div.style.position = &#x27;absolute&#x27;;
                div.style.height = &#x27;12px&#x27;;
                div.style.textAlign = &#x27;center&#x27;;
                div.style.left = 0;
                div.style.right = 0;
                div.style.top = 0;
                div.style.bottom = 0;
                div.style.margin = &#x27;auto&#x27;;
                div.style.display = &#x27;none&#x27;;
                div.id = &#x27;panda-rotate&#x27;;
                game.System.rotateDiv = div;
                document.body.appendChild(game.System.rotateDiv);

                if (game.System.rotateImg) {
                    var img = new Image();
                    var me = this;
                    img.onload = function() {
                        div.image = img;
                        div.style.height = img.height + &#x27;px&#x27;;
                        div.appendChild(img);
                        me.resizeRotateImage();
                    };
                    if (game.System.rotateImg.indexOf(&#x27;data:&#x27;) === 0) {
                        img.src = game.System.rotateImg;
                    }
                    else {
                        img.src = game.getMediaPath(game.System.rotateImg);
                    }
                    img.style.position = &#x27;relative&#x27;;
                    img.style.maxWidth = &#x27;100%&#x27;;
                }
            }
        }
        else {
            // Desktop center
            if (game.System.center || game.System.left || game.System.top) this.canvas.style.position = &#x27;absolute&#x27;;
            if (game.System.center) {
                this.canvas.style.top = 0;
                this.canvas.style.left = 0;
                this.canvas.style.bottom = 0;
                this.canvas.style.right = 0;
            }
            else if (game.System.left || game.System.top) {
                this.canvas.style.left = game.System.left + &#x27;px&#x27;;
                this.canvas.style.top = game.System.top + &#x27;px&#x27;;
            }

            // Desktop scaling
            if (game.System.scale) {
                var minWidth = game.System.minWidth === &#x27;auto&#x27; ? this.retina ? this.width / 4 : this.width / 2 : game.System.minWidth;
                var minHeight = game.System.minHeight === &#x27;auto&#x27; ? this.retina ? this.height / 4 : this.height / 2 : game.System.minHeight;
                var maxWidth = game.System.maxWidth === &#x27;auto&#x27; ? this.retina ? this.width / 2 : this.width : game.System.maxWidth;
                var maxHeight = game.System.maxHeight === &#x27;auto&#x27; ? this.retina ? this.height / 2 : this.height : game.System.maxHeight;
                if (game.System.minWidth) this.canvas.style.minWidth = minWidth + &#x27;px&#x27;;
                if (game.System.minHeight) this.canvas.style.minHeight = minHeight + &#x27;px&#x27;;
                if (game.System.maxWidth &amp;&amp; !game.System.scaleToFit) this.canvas.style.maxWidth = maxWidth + &#x27;px&#x27;;
                if (game.System.maxHeight &amp;&amp; !game.System.scaleToFit) this.canvas.style.maxHeight = maxHeight + &#x27;px&#x27;;
            }
        }

        if (typeof window.onorientationchange !== &#x27;undefined&#x27; &amp;&amp; !game.device.android) {
            window.onorientationchange = this.onResize.bind(this);
        }
        else {
            window.onresize = this.onResize.bind(this);
        }

        this.onResize();
    },

    checkOrientation: function() {
        this.orientation = window.innerWidth &lt; window.innerHeight ? &#x27;portrait&#x27; : &#x27;landscape&#x27;;
        if (game.device.android2 &amp;&amp; window.innerWidth === 320 &amp;&amp; window.innerHeight === 251) {
            // Android 2.3 portrait fix
            this.orientation = &#x27;portrait&#x27;;
        }
        
        if (this.width &gt; this.height &amp;&amp; this.orientation !== &#x27;landscape&#x27;) this.rotateScreenVisible = true;
        else if (this.width &lt; this.height &amp;&amp; this.orientation !== &#x27;portrait&#x27;) this.rotateScreenVisible = true;
        else this.rotateScreenVisible = false;

        if (!game.System.rotateScreen) this.rotateScreenVisible = false;

        this.canvas.style.display = this.rotateScreenVisible ? &#x27;none&#x27; : &#x27;block&#x27;;
        if (game.System.rotateDiv) game.System.rotateDiv.style.display = this.rotateScreenVisible ? &#x27;block&#x27; : &#x27;none&#x27;;

        if (this.rotateScreenVisible &amp;&amp; game.System.bgColorRotate) document.body.style.backgroundColor = game.System.bgColorRotate;
        if (!this.rotateScreenVisible &amp;&amp; game.System.bgColorMobile) document.body.style.backgroundColor = game.System.bgColorMobile;

        if (this.rotateScreenVisible &amp;&amp; game.System.bgImageRotate) document.body.style.backgroundImage = &#x27;url(&#x27; + game.getMediaPath(game.System.bgImageRotate) + &#x27;)&#x27;;
        if (!this.rotateScreenVisible &amp;&amp; game.System.bgImageMobile) document.body.style.backgroundImage = &#x27;url(&#x27; + game.getMediaPath(game.System.bgImageMobile) + &#x27;)&#x27;;

        if (this.rotateScreenVisible &amp;&amp; game.system &amp;&amp; typeof game.system.pause === &#x27;function&#x27;) game.system.pause();
        if (!this.rotateScreenVisible &amp;&amp; game.system &amp;&amp; typeof game.system.resume === &#x27;function&#x27;) game.system.resume();

        if (this.rotateScreenVisible) this.resizeRotateImage();
    },

    resizeRotateImage: function() {
        if (this.rotateScreenVisible &amp;&amp; game.System.rotateDiv.image) {
            if (window.innerHeight &lt; game.System.rotateDiv.image.height) {
                game.System.rotateDiv.image.style.height = window.innerHeight + &#x27;px&#x27;;
                game.System.rotateDiv.image.style.width = &#x27;auto&#x27;;
                game.System.rotateDiv.style.height = window.innerHeight + &#x27;px&#x27;;
                game.System.rotateDiv.style.bottom = &#x27;auto&#x27;;
            }
        }
    },

    onResize: function() {
        // Mobile orientation
        if (game.device.mobile) this.checkOrientation();

        if (!game.System.scale) return;

        if (game.device.mobile) {
            this.ratio = this.orientation === &#x27;landscape&#x27; ? this.width / this.height : this.height / this.width;

            this.resizeToFill();

            // Mobile resize
            var width = window.innerWidth;
            var height = window.innerHeight;

            // iOS innerHeight bug fixes
            if (game.device.iOS7 &amp;&amp; window.innerHeight === 256) height = 320;
            if (game.device.iOS7 &amp;&amp; window.innerHeight === 319) height = 320;
            if (game.device.iOS7 &amp;&amp; game.device.pixelRatio === 2 &amp;&amp; this.orientation === &#x27;landscape&#x27;) height += 2;
            if (game.device.iPad &amp;&amp; height === 671) height = 672;

            // Landscape game
            if (this.width &gt; this.height) {
                if (this.orientation === &#x27;landscape&#x27; &amp;&amp; height * this.ratio &lt;= width) {
                    this.canvas.style.height = height + &#x27;px&#x27;;
                    this.canvas.style.width = height * this.width / this.height + &#x27;px&#x27;;
                }
                else {
                    this.canvas.style.width = width + &#x27;px&#x27;;
                    this.canvas.style.height = width * this.height / this.width + &#x27;px&#x27;;
                }
            }
            // Portrait game
            else {
                if (this.orientation === &#x27;portrait&#x27; &amp;&amp; width * this.ratio &lt;= height) {
                    this.canvas.style.width = width + &#x27;px&#x27;;
                    this.canvas.style.height = width * this.height / this.width + &#x27;px&#x27;;
                }
                else {
                    this.canvas.style.height = height + &#x27;px&#x27;;
                    this.canvas.style.width = height * this.width / this.height + &#x27;px&#x27;;
                }
            }

            if (!game.device.ejecta) window.scroll(0, 1);

            if (!this.rotateScreenVisible &amp;&amp; game.loader &amp;&amp; !game.loader.started) game.loader.start();
        }
        else {
            // Desktop resize
            if (window.innerWidth === 0) return; // Chrome bug
            if (window.innerWidth &lt; this.width || window.innerHeight &lt; this.height || game.System.scaleToFit) {
                if (window.innerWidth / this.width &lt; window.innerHeight / this.height) {
                    this.canvas.style.width = window.innerWidth + &#x27;px&#x27;;
                    this.canvas.style.height = Math.floor(window.innerWidth * (this.height / this.width)) + &#x27;px&#x27;;
                }
                else {
                    this.canvas.style.height = window.innerHeight + &#x27;px&#x27;;
                    this.canvas.style.width = Math.floor(window.innerHeight * (this.width / this.height)) + &#x27;px&#x27;;
                }
            }
            else {
                this.canvas.style.width = this.width + &#x27;px&#x27;;
                this.canvas.style.height = this.height + &#x27;px&#x27;;
            }
        }
    }
});

game.addAttributes(&#x27;System&#x27;, {
    /**
        Enable/disable canvas centering.
        @attribute {Boolean} center
        @default true
    **/
    center: true,
    /**
        Canvas position from left, when centering is disabled.
        @attribute {Number} left
        @default 0
    **/
    left: 0,
    /**
        Canvas position from top, when centering is disabled.
        @attribute {Number} top
        @default 0
    **/
    top: 0,
    /**
        Enable/disable canvas scaling.
        @attribute {Boolean} resize
        @default true
    **/
    scale: true,
    /**
        Minimum width for canvas, when using scaling on desktop.
        @attribute {Number} minWidth
        @default auto
    **/
    minWidth: &#x27;auto&#x27;,
    /**
        Minimum height for canvas, when using scaling on desktop.
        @attribute {Number} minHeight
        @default auto
    **/
    minHeight: &#x27;auto&#x27;,
    /**
        Maximum width for canvas, when using scaling on desktop.
        @attribute {Number} maxWidth
        @default auto
    **/
    maxWidth: &#x27;auto&#x27;,
    /**
        Maximum height for canvas, when using scaling on desktop.
        @attribute {Number} maxHeight
        @default auto
    **/
    maxHeight: &#x27;auto&#x27;,
    /**
        Scaling method for CocoonJS.
        @attribute {ScaleToFill|ScaleAspectFit|ScaleAspectFill} idtkScale
        @default ScaleAspectFit
    **/
    idtkScale: &#x27;ScaleAspectFit&#x27;,
    /**
        Use ScreenCanvas on CocoonJS.
        http://support.ludei.com/hc/en-us/articles/201810268-ScreenCanvas
        @attribute {Boolean} screenCanvas
        @default true
    **/
    screenCanvas: true,
    /**
        HiRes mode.
        @attribute {Number} hires
        @default 0
    **/
    hires: 0,
    /**
        Use Retina mode.
        @attribute {Boolean} retina
        @default false
    **/
    retina: false,
    /**
        Pause game engine, when page is hidden.
        @attribute {Boolean} pauseOnHide
        @default true
    **/
    pauseOnHide: true,
    /**
        Use rotate screen on mobile.
        @attribute {Boolean} rotateScreen
        @default true
    **/
    rotateScreen: true,
    /**
        System width.
        @attribute {Number} width
        @default 1024
    **/
    width: 1024,
    /**
        System height.
        @attribute {Number} height
        @default 768
    **/
    height: 768,
    /**
        Body background color.
        @attribute {String} bgColor
        @default null
    **/
    bgColor: null,
    /**
        Body background color for mobile.
        @attribute {String} bgColorMobile
        @default null
    **/
    bgColorMobile: null,
    /**
        Body background color for mobile rotate screen.
        @attribute {String} bgColorRotate
        @default null
    **/
    bgColorRotate: null,
    /**
        Body background image.
        @attribute {String} bgImage
        @default null
    **/
    bgImage: null,
    /**
        Body background image for mobile.
        @attribute {String} bgImageMobile
        @default null
    **/
    bgImageMobile: null,
    /**
        Body background image for mobile rotate screen.
        @attribute {String} bgImageRotate
        @default null
    **/
    bgImageRotate: null,
    /**
        Body background image position.
        @attribute {String} bgPosition
        @default null
    **/
    bgPosition: null,
    /**
        Rotate message for mobile.
        @attribute {String} rotateMsg
        @default Please rotate your device
    **/
    rotateMsg: &#x27;Please rotate your device&#x27;,
    /**
        Rotate image for mobile.
        @attribute {URL} rotateImg
        @default null
    **/
    rotateImg: null,
    /**
        Enable WebGL renderer.
        @attribute {Boolean} webGL
        @default false
    **/
    webGL: false,
    /**
        Use transparent renderer.
        @attribute {Boolean} transparent
        @default false
    **/
    transparent: false,
    /**
        Use antialias (only on WebGL).
        @attribute {Boolean} antialias
        @default false
    **/
    antialias: false,
    /**
        Resize canvas to fill screen on mobile.
        @attribute {Boolean} resizeToFill
        @default false
    **/
    resizeToFill: false,
    /**
        Default start scene.
        @attribute {String} startScene
        @default Main
    **/
    startScene: &#x27;Main&#x27;,
    /**
        Scale canvas to fit window size on desktop.
        @attribute {Boolean} scaleToFit
        @default false
    **/
    scaleToFit: false,
    /**
        Id for canvas element.
        @attribute {String} canvasId
        @default canvas
    **/
    canvasId: &#x27;canvas&#x27;,
    /**
        Canvas scale mode.
        @attribute {String} scaleMode
        @default linear
    **/
    scaleMode: &#x27;linear&#x27;
});

});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
